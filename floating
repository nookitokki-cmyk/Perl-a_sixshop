<style>
/* 플로팅 컨테이너 */
.floating-container {
  position: fixed;
  right: {{property.positionRight}}px;
  bottom: {{property.positionBottom}}px;
  z-index: 9999;
  display: flex;
  flex-direction: column;
  gap: {{property.buttonGap}}px;
}

/* 버튼 공통 스타일 */
.floating-button {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 20px;
  border: none;
  border-radius: 50px;
  font-size: 14px;
  font-weight: 600;
  font-family: var(--font-family-body);
  cursor: pointer;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  transition: all 0.3s ease-in-out;
  white-space: nowrap;
  text-decoration: none;
}

.floating-button:hover {
  transform: translateY(-2px) scale(1.03);
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
}

.floating-button:active {
  transform: translateY(0) scale(0.98);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
}

/* 각 버튼의 개별 스타일 */
{{#each property.buttons}}
.floating-button-{{@index}} {
  background-color: {{bgColor}};
  color: {{textColor}};
  {{#if (eq buttonType 'email')}}
  border: 1px solid #E0E0E0;
  {{/if}}
}
{{/each}}

/* 아이콘 SVG 스타일 */
.icon-svg {
  width: 20px;
  height: 20px;
  flex-shrink: 0;
}

/* 모바일 반응형 */
@media (max-width: 768px) {
  .floating-container {
    right: {{property.positionRight}}px;
    bottom: {{property.positionBottom}}px;
  }
  
  .floating-button {
    padding: 10px 16px;
    font-size: 13px;
  }
  
  .icon-svg {
    width: 18px;
    height: 18px;
  }
}

/* 접근성 개선 */
.floating-button:focus {
  outline: 3px solid rgba(66, 153, 225, 0.5);
  outline-offset: 2px;
}

/* 버튼 텍스트 선택 방지 */
.floating-button {
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}

/* 스크롤해도 고정 유지 */
.floating-container {
  pointer-events: auto;
}
</style>

<template>
  <div class="floating-container">
    {{#each property.buttons}}
    <a 
      href="{{link.value}}" 
      class="floating-button floating-button-{{@index}}" 
      data-button-type="{{buttonType}}"
      {{#if openNewTab}}target="_blank" rel="noopener noreferrer"{{/if}}
      aria-label="{{label}}">
      
      <!-- 버튼 타입별 아이콘 -->
      {{#if (eq buttonType 'kakao')}}
      <svg class="icon-svg" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
        <path d="M12 3C6.48 3 2 6.58 2 11C2 13.39 3.27 15.53 5.29 16.92L4.5 20.5L8.34 18.42C9.5 18.78 10.73 19 12 19C17.52 19 22 15.42 22 11C22 6.58 17.52 3 12 3Z"/>
      </svg>
      {{/if}}
      
      {{#if (eq buttonType 'blog')}}
      <svg class="icon-svg" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
        <path d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM9 17H7V10H9V17ZM13 17H11V7H13V17ZM17 17H15V14H17V17Z"/>
      </svg>
      {{/if}}
      
      {{#if (eq buttonType 'instagram')}}
      <svg class="icon-svg" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
        <path d="M7.8 2H16.2C19.4 2 22 4.6 22 7.8V16.2C22 19.4 19.4 22 16.2 22H7.8C4.6 22 2 19.4 2 16.2V7.8C2 4.6 4.6 2 7.8 2ZM7.6 4C5.61 4 4 5.61 4 7.6V16.4C4 18.39 5.61 20 7.6 20H16.4C18.39 20 20 18.39 20 16.4V7.6C20 5.61 18.39 4 16.4 4H7.6ZM17.25 5.5C17.94 5.5 18.5 6.06 18.5 6.75C18.5 7.44 17.94 8 17.25 8C16.56 8 16 7.44 16 6.75C16 6.06 16.56 5.5 17.25 5.5ZM12 7C14.76 7 17 9.24 17 12C17 14.76 14.76 17 12 17C9.24 17 7 14.76 7 12C7 9.24 9.24 7 12 7ZM12 9C10.34 9 9 10.34 9 12C9 13.66 10.34 15 12 15C13.66 15 15 13.66 15 12C15 10.34 13.66 9 12 9Z"/>
      </svg>
      {{/if}}
      
      {{#if (eq buttonType 'email')}}
      <svg class="icon-svg" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
        <path d="M20 4H4C2.9 4 2 4.9 2 6V18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V6C22 4.9 21.1 4 20 4ZM20 8L12 13L4 8V6L12 11L20 6V8Z"/>
      </svg>
      {{/if}}
      
      {{#if (eq buttonType 'link')}}
      <svg class="icon-svg" viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
        <path d="M3.9 12C3.9 10.29 5.29 8.9 7 8.9H11V7H7C4.24 7 2 9.24 2 12C2 14.76 4.24 17 7 17H11V15.1H7C5.29 15.1 3.9 13.71 3.9 12ZM8 13H16V11H8V13ZM17 7H13V8.9H17C18.71 8.9 20.1 10.29 20.1 12C20.1 13.71 18.71 15.1 17 15.1H13V17H17C19.76 17 22 14.76 22 12C22 9.24 19.76 7 17 7Z"/>
      </svg>
      {{/if}}
      
      <span>{{label}}</span>
    </a>
    {{/each}}
  </div>
</template>

<script>
const container = bm.container;
const context = bm.context;

// 버튼 클릭 이벤트 처리
function handleButtonClick(event) {
  const button = event.target.closest('.floating-button');
  if (!button) return;
  
  const buttonType = button.getAttribute('data-button-type');
  
}

// 이벤트 리스너 등록
container.addEventListener('click', handleButtonClick);

// 컨텍스트 변경 시 재초기화 (에디터 프리뷰 지원)
bm.onContextChange = () => {
  // 버튼 목록이 변경될 수 있으므로 DOM 재확인
};

// 블록 제거 시 정리
bm.onDestroy = () => {
  container.removeEventListener('click', handleButtonClick);
};
</script>

{"settings":[{"type":"TITLE","content":"누끼토끼가 제작한 블록입니다."},{"type":"DESCRIPTION","content":"【 사용 안내 】\n고객님께서 직접 세팅하실 수 있도록\n필요한 모든 설정 패널을 구현했습니다.\n추가 패널이나 기능 확장이 필요한 경우,\n블록 AI를 활용하시면 됩니다."},{"type":"TITLE","content":"플로팅 버튼 설정"},{"type":"LIST","id":"buttons","label":"버튼 목록","maxCount":5,"settings":[{"type":"SELECT","id":"buttonType","label":"버튼 타입","options":[{"value":"kakao","label":"카카오톡"},{"value":"blog","label":"블로그"},{"value":"instagram","label":"인스타그램"},{"value":"email","label":"이메일"},{"value":"link","label":"일반 링크"}],"default":"kakao"},{"type":"TEXT","id":"label","label":"버튼 텍스트","default":"버튼"},{"type":"LINK","id":"link","label":"링크","default":{"type":"url","value":"/","label":"/"}},{"type":"CHECKBOX","id":"openNewTab","label":"새 탭에서 열기","default":true},{"type":"COLOR_PICKER","id":"bgColor","label":"배경색","default":"#FEE500"},{"type":"COLOR_PICKER","id":"textColor","label":"텍스트 색상","default":"#000000"}]},{"type":"TITLE","content":"위치 설정"},{"type":"RANGE","id":"positionRight","label":"우측 여백","min":10,"max":100,"step":5,"unit":"px","default":20},{"type":"RANGE","id":"positionBottom","label":"하단 여백","min":10,"max":100,"step":5,"unit":"px","default":20},{"type":"RANGE","id":"buttonGap","label":"버튼 간격","min":5,"max":30,"step":5,"unit":"px","default":12}],"property":{"buttons":[{"buttonType":"kakao","label":"톡상담","link":{"type":"url","value":"http://pf.kakao.com/_xlxnxexjG","label":"카카오톡 채널"},"openNewTab":true,"bgColor":"#FEE500","textColor":"#000000"},{"buttonType":"email","label":"B2B문의","link":{"type":"url","value":"mailto:kjh@selporcelain.kr","label":"이메일"},"openNewTab":false,"bgColor":"#FFFFFF","textColor":"#333333"}],"positionRight":20,"positionBottom":20,"buttonGap":12}}
